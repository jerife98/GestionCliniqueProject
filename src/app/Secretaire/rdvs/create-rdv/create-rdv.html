<div class="flex items-stretch bg-white min-h-screen">
  <!-- sidebar -->
  <div class="hidden md:flex flex-col w-64 bg-[url('/side_bar.png')] mr-5">
    <div class="flex items-center justify-center h-16 bg-[url('/side_bar.png')] py-15">
      <img src="logo_clinic.png" alt="logo de la clinique" />
    </div>
    <div class="flex flex-col h-full">
      <nav class="flex-1 px-3 py-4 bg-[url('/side_bar.png')]">
        <!-- Rendez-vous -->
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff]" [routerLink]="['/rendez-vous']"
          routerLinkActive="bg-[#9f9fff] text-white" [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-calendar-check h-6 w-6 mr-2"></i>
          Rendez-vous
        </a>

        <!-- Patients -->
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff]" [routerLink]="['/Malade']"
          routerLinkActive="bg-[#9f9fff] text-white" [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-user-injured h-6 w-6 mr-2"></i>
          Patients
        </a>

        <!-- Calendrier -->
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff]" [routerLink]="['/calendar']"
          routerLinkActive="bg-[#9f9fff] text-white" [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-calendar-alt h-6 w-6 mr-2"></i>
          Calendrier
        </a>

        <!-- Facture -->
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff]" [routerLink]="['/facture']"
          routerLinkActive="bg-[#9f9fff] text-white" [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-file-invoice-dollar h-6 w-6 mr-2"></i>
          Facture
        </a>
      </nav>

      <div class="mt-auto px-3 py-4">
        <button
          class="w-full flex items-center px-4 py-2 text-black hover:bg-red-500 hover:text-white rounded-lg  bg-red-500"
          (click)="logout()">
          <i class="fas fa-sign-out-alt mr-2"></i> D√©connexion
        </button>
      </div>

    </div>
  </div>
  <!-- Main content -->
  <div class="flex flex-col flex-1">
    <div class="flex justify-between items-center my-6">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">
          Gestion des Rendez-vous
        </h1>
        <nav class="flex mt-3" aria-label="Breadcrumb">
          <ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse">
            <li>
              <div class="flex items-center">
                <a class="ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white"
                  [routerLink]="['/rdv']" routerLinkActive="active">
                  Liste des Rendez-vous</a>
              </div>
            </li>
            <li aria-current="page">
              <div class="flex items-center">
                <svg class="rtl:rotate-180 w-3 h-3 text-gray-700 mx-1 hover:text-blue-600" aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="m1 9 4-4-4-4" />
                </svg>
                <a class="ms-1 text-sm font-medium text-gray-500 md:ms-2 dark:text-gray-400"
                  [routerLink]="['/creates-rdv']" routerLinkActive="active">Cr√©ation des rendez-vous</a>
              </div>
            </li>
          </ol>
        </nav>
      </div>
      <div class="flex items-center space-x-4">
        <button class="relative">
          <span class="absolute top-0 right-0 block h-2 w-2 rounded-full bg-[var(--Asec)]"></span>
          <i class="far fa-bell text-3xl"></i>
        </button>
        <app-current-user></app-current-user>
      </div>
    </div>

    <!-- formulaire de recherche des utilisateurs -->
    <div class="p-6 space-y-4">
      <div class="flex flex-col items-center justify-center min-h-screen bg-white">
        <form [formGroup]="rdvForm" (ngSubmit)="onSubmit()"
          class="w-3/4 bg-[#eee] shadow-lg rounded-xl p-8 border border-gray-100">
          <app-infos-patient *ngIf="InfosFormGroup" [formGroup]="InfosFormGroup"
            [isVisible]="false"></app-infos-patient>
          <!-- Titre principal -->
          <h2 class="text-2xl font-bold my-6 text-gray-800">
            Cr√©er un rendez-vous
          </h2>
          <hr class="mb-4 border-[#9f9fff] border-2" />

          <!-- Informations g√©n√©rales -->
          <div>
            <h3 class="text-lg font-semibold text-gray-600 mb-2">
              Informations g√©n√©rales
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- <div>
                <label class="block text-gray-700 mb-1">M√©decin</label>
                <select
                  formControlName="medecinId"
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300"
                >
                  <option *ngFor="let doc of medecins" [value]="doc.id">
                    {{ doc.nom }} {{ doc.prenom }}
                  </option>
                </select>
              </div> -->
              <div>
                <label class="block text-gray-700 mb-1">Jour</label>
                <input formControlName="jour" required type="date"
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300" />
                <!-- <p class="text-sm text-blue-500 mt-1">‚ö†Ô∏è Date minimale : aujourd\'hui</p> -->
                <p *ngIf="rdvForm.get('jour')?.touched && rdvForm.get('jour')?.invalid" class="text-red-500">
                  La date est obligatoire
                </p>


              </div>
              <div>
                <label class="block text-gray-700 mb-1">Heure</label>
                <input formControlName="heure" required type="time"
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300" />
                <p class="text-sm text-blue-500 mt-1">üïó Heures autoris√©es : 07h00 √† 20h00</p>

              </div>
              <div>
                <label class="block text-gray-700 mb-1">Notes</label>
                <textarea formControlName="notes"
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300"
                  placeholder="Notes"></textarea>
              </div>
              <div>
                <label class="block text-gray-700 mb-1">Service m√©dical</label>
                <select formControlName="serviceMedical" required
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300">
                  <option value="">S√©lectionnez un service</option>
                  <option *ngFor="let service of services" [value]="service">
                    {{ service }}
                  </option>
                </select>
              </div>
              <!-- S√©lection du m√©decin (se charge apr√®s le service) -->
              <div *ngIf="filteredMedecins.length > 0">
                <label class="block text-gray-700 mb-1" for="m√©decin">M√©decin</label>
                <select formControlName="medecinId"
                  class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-300" required
                  [disabled]="filteredMedecins.length === 0">
                  <option value="">S√©lectionnez un m√©decin</option>
                  <option *ngFor="let medecin of filteredMedecins" [value]="medecin.id">
                    {{ medecin.nom }} {{ medecin.prenom }}
                  </option>
                </select>
              </div>

              <!-- Message conditionnel -->
              <div *ngIf="filteredMedecins.length === 0 && !isLoading" class="mt-2 text-red-500">
                Aucun m√©decin disponible pour le service "{{
                rdvForm.get('serviceMedical')?.value }}"
              </div>
              <div class="flex gap-4 justify-center mt-8">
                <button type="button" (click)="onCancel()"
                  class="px-6 py-2 rounded border border-blue-400 text-blue-700 bg-white hover:bg-blue-50 transition">
                  Annuler
                </button>
                <button type="submit" [disabled]="!rdvForm.valid"
                  class="px-6 py-2 rounded bg-blue-500 text-white font-medium hover:bg-blue-600 transition disabled:opacity-50">
                  Cr√©er le rendez-vous
                </button>
              </div>
            </div>
          </div>
        </form>
        <!-- ... ton formulaire de RDV ici ... -->

        <div *ngIf="facture" class="mt-8 p-6 border rounded bg-white shadow">
          <h3 class="text-xl font-bold mb-4">Facture associ√©e</h3>
          <p><b>ID :</b> {{ facture.id }}</p>
          <p><b>Montant :</b> {{ facture.montant }} XAF</p>
          <p><b>Statut :</b> {{ facture.statutPaiement }}</p>
          <p><b>Mode de paiement :</b> {{ facture.modePaiement || 'Non d√©fini' }}</p>

          <div class="mt-4">
            <label class="block mb-2">Payer par :</label>
            <select #paiement (change)="payerFacture(paiement.value)" class="border p-2 rounded w-64">
              <option value="ESPECES">Esp√®ces</option>
              <option value="CARTE_BANCAIRE">Carte Bancaire</option>
              <option value="VIREMENT">Virement</option>
              <option value="CHEQUE">Ch√®que</option>
              <option value="MOBILE_MONEY">Mobile Money</option>
            </select>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>