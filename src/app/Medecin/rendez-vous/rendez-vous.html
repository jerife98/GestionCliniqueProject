<div class="flex items-stretch bg-white min-h-screen">
  <!-- sidebar -->
  <div class="hidden md:flex flex-col w-64 bg-[url('/side_bar.png')] mr-5">
    <div class="flex items-center justify-center h-16 bg-[url('/side_bar.png')] py-15">
      <img src="logo_clinic.png" alt="logo de la clinique" />
    </div>
    <div class="flex flex-col h-full">
      <nav class="flex-1 px-3 py-4 bg-[url('/side_bar.png')]">
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff] active:bg-[#9f9fff]"
          [routerLink]="['/rendez-vous']" routerLinkActive="bg-[#9f9fff] text-white"
          [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-calendar-check h-6 w-6 mr-2"></i>
          Rendez-vous
        </a>
        <a class="flex items-center px-4 py-2 mt-2 text-black hover:bg-[#9f9fff] active:bg-[#9f9fff]"
          [routerLink]="['/calendrier']" routerLinkActive="bg-[#9f9fff] text-white"
          [routerLinkActiveOptions]="{ exact: true }">
          <i class="fas fa-calendar-alt h-6 w-6 mr-2"></i>
          Calendrier
        </a>
      </nav>

      <div class="mt-auto px-3 py-4">
        <button
          class="w-full flex items-center px-4 py-2 text-black hover:bg-red-500 hover:text-white rounded-lg  bg-red-500"
          (click)="logout()">
          <i class="fas fa-sign-out-alt mr-2"></i> D√©connexion
        </button>
      </div>
    </div>
  </div>
  <!-- Main content -->
  <div class="flex flex-col flex-1">
    <div class="flex justify-between items-center my-6">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">Gestion des Rendez-vous</h1>
        <nav class="flex mt-3" aria-label="Breadcrumb">
          <ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse">
            <li>
              <div class="flex items-center">
                <a class="ms-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ms-2 dark:text-gray-400 dark:hover:text-white"
                  [routerLink]="['/rendez-vous']" routerLinkActive="bg-[#9f9fff] text-white"
                  [routerLinkActiveOptions]="{ exact: true }">
                  Liste des rendez-vous</a>
              </div>
            </li>
            <li aria-current="page">
              <div class="flex items-center">
                <svg class="rtl:rotate-180 w-3 h-3 text-gray-700 mx-1 hover:text-blue-600" aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="m1 9 4-4-4-4" />
                </svg>
                <a class="ms-1 text-sm font-medium text-gray-500 md:ms-2 dark:text-gray-400"
                  [routerLink]="['/create-rdv']" routerLinkActive="bg-[#9f9fff] text-white"
                  [routerLinkActiveOptions]="{ exact: true }">

                  Cr√©ation des rendez-vous</a>
              </div>
            </li>
          </ol>
        </nav>
      </div>
      <div class="flex items-center space-x-4">
        <button class="relative">
          <span class="absolute top-0 right-0 block h-2 w-2 rounded-full bg-[var(--Asec)]"></span>
          <i class="far fa-bell text-3xl"></i>
        </button>
        <app-current-user></app-current-user>
      </div>
    </div>

    <!-- Barre de recherche -->
    <div class="my-4 flex justify-between mx-4">
      <input type="text" [(ngModel)]="searchText" placeholder="Tapez votre recherche ici"
        class="md:w-3/5 p-3 rounded-4xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-[var(--Aprim)]" />
    </div>

    <!-- Statistiques globales -->
    <div class="bg-[var(--Aprim)] rounded-3xl shadow p-6 mb-6 mx-3">
      <div class="flex justify-between items-center">
        <div>
          <h2 class="text-3xl font-bold text-gray-700 mb-5">Rendez-vous</h2>
        </div>
        <div class="flex justify-center items-center gap-2 mb-5" *ngIf="totalPages() > 1">
          <button class="px-3 py-1 rounded border text-gray-500" [disabled]="currentPage === 1"
            (click)="goToPage(currentPage - 1)">
            Pr√©c√©dent
          </button>
          <ng-container *ngFor="let page of [].constructor(totalPages); let i = index">
            <button class="px-3 py-1 rounded border" [class.bg-blue-200]="currentPage === i+1" (click)="goToPage(i+1)">
              {{ i + 1 }}
            </button>
          </ng-container>
          <button class="px-3 py-1 rounded border text-gray-500" [disabled]="currentPage === totalPages()"
            (click)="goToPage(currentPage + 1)">
            Suivant
          </button>
        </div>
      </div>
      <hr class="mb-4 border-[#9f9fff] border-2" />
      <!-- Pagination -->

      <!-- formulaire de recherche des utilisateurs -->
      <div class="flex justify-end mb-4" *ngIf="isUrgences()">
        <button class="bg-orange-500 text-white px-4 py-2 rounded-xl hover:bg-orange-600"
          (click)="goToConsultationUrgence()">
          ‚ö° Consultation d‚Äôurgence
        </button>
      </div>

      <div class="p-6 space-y-4">
        <!-- Tableau des utilisateurs -->
        <div class="overflow-x-auto rounded-lg shadow border border-white mt-6">
          <table class="min-w-full divide-y divide-white text-sm">
            <thead class="bg-[#9f9fff] text-white">
              <tr *ngFor="let rendezVous of paginatedRendezVous()" (click)="openModal(rendezVous)"
                style="cursor: pointer">
                <th class="px-4 py-2">Date</th>
                <th class="px-4 py-2">Heure</th>
                <th class="px-4 py-2">Salle</th>
                <th class="px-4 py-2">Adresse</th>
                <th class="px-4 py-2">Nom et prenom</th>
                <th class="px-4 py-2">Statut</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
              <tr *ngFor="let rendezVous of paginatedRendezVous()" (click)="openModal(rendezVous)"
                style="cursor: pointer">
                <td class="px-4 py-2">{{ rendezVous.jour }}</td>
                <td class="px-4 py-2">{{ rendezVous.heure }}</td>
                <td class="px-4 py-2">{{ rendezVous.serviceMedical }}</td>
                <td class="px-4 py-2">{{ rendezVous.nomSalle }}</td>
                <td class="px-4 py-2">{{ rendezVous.patientNomComplet }}</td>
                <td class="px-4 py-2 flex space-x-2">{{ rendezVous.statut }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Modal -->
        <div *ngIf="selectedRdv" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div class="bg-white rounded-2xl shadow-lg p-6 w-96">
            <h2 class="text-xl font-bold mb-4">Actions sur le rendez-vous</h2>
            <p class="mb-6 text-gray-700">
              Patient : <strong>{{ selectedRdv.patientNomComplet }}</strong><br />
              Date : {{ selectedRdv.jour }} √† {{ selectedRdv.heure }}
            </p>

            <div class="flex flex-col gap-3">
              <button class="w-full bg-blue-500 text-white py-2 rounded-xl hover:bg-blue-600"
                (click)="goToDossierMedical()">
                üìÅ Dossier m√©dical
              </button>

              <button class="w-full bg-green-500 text-white py-2 rounded-xl hover:bg-green-600"
                (click)="goToConsultation()">
                üíä Consultation
              </button>

              <button class="w-full bg-red-500 text-white py-2 rounded-xl hover:bg-red-600"
                (click)="cancelRendezVous()">
                ‚ùå Annuler
              </button>
            </div>

            <button class="mt-6 w-full bg-gray-300 py-2 rounded-xl hover:bg-gray-400" (click)="closeModal()">
              Fermer
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>